<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Using BrandCAPTCHA with PHP</title>
</head>

<body>
<h1 itemprop="name">Using BrandCAPTCHA with PHP</h1>
<div itemprop="articleBody">
  <p>The BrandCAPTCHA PHP Library provides a simple way to place a Brand<a href="http://es.wikipedia.org/wiki/Captcha" target="_blank">CAPTCHA</a> on your PHP website, helping you stop bots from abusing it. The library wraps the BrandCAPTCHA API.</p>
  <p>To use BrandCAPTCHA with PHP, you will only need to include the file  "brandcaptchalib.php". The other files are examples, readme, etc, they don't affect functionality.</p>
  <h2>Quick Start</h2>
  <p>After you've obtained your API keys, below are basic instructions for installing BrandCAPTCHA on your site. <br />
  </p>
  <h3>Client Side</h3>
  <p>If you want to use the PHP library to display the BrandCAPTCHA widget, you'll need to insert this snippet of code inside the &lt;form&gt; element where the BrandCAPTCHA widget will be placed: </p>
  <pre>require_once('brandcaptchalib.php');
</pre>
  <pre>$publickey = &quot;your_public_key&quot;;</pre>
  <pre># the response from BrandCAPTCHA
$resp = null;
# the error code from BrandCAPTCHA, if any
$error = null;</pre>
  <pre>
echo brandcaptcha_get_html($publickey, $error);</pre>
  <p>With the code, your form might look something like this:</p>
  <pre>&lt;html&gt;
&lt;body&gt;
&lt;form action=&quot;process_form.php&quot; method=&quot;post&quot;&gt;

    &lt;?php

        require_once('brandcaptchalib.php');
        $publickey = &quot;your_public_key&quot;;
        echo brandcaptcha_get_html($publickey, $error);

    ?&gt;
    
    &lt;br/&gt;
    &lt;input type=&quot;submit&quot; value=&quot;submit&quot; /&gt;
&lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
  <p>Don't forget to set $publickey by replacing your_public_key with your API public key.</p>
  <p>Note that the value of the "action" attribute is "process_form.php". Now, process_form.php is the destination file in which the values of this form are submitted to. So you will need a file process_form.php in the same location as the client html.
  </p>
  <p>The require_once function in the example above expects brandcaptchalib.php to be in the same directory as your form file. If it is in another directory, you must link it appropriately. For example if your brandcaptchalib.php is in the directory called "brandcaptcha" that is on the same level as your form file, the function will look like this: require_once('brandcaptcha/brandcaptchalib.php').
  </p>
  <h3>Server Side</h3>
  <p>The following code should be placed at the top of the process_form.php:</p>
  <pre>  &lt;?php</pre>
  <pre>	require_once('brandcaptchalib.php');
        $privatekey = &quot;your_private_key&quot;;</pre>
  <pre>	# the response from BrandCAPTCHA
	$resp = null;
        # the error code from BrandCAPTCHA, if any
        $error = null;</pre>
  <pre>	# was there a BrandCAPTCHA response?
	if ( isset($_POST[&quot;brand_cap_answer&quot;]) &amp;&amp; $_POST[&quot;brand_cap_answer&quot;]) {
		$resp = brandcaptcha_check_answer ($privatekey,
		$_SERVER[&quot;REMOTE_ADDR&quot;],
		$_POST[&quot;brand_cap_challenge&quot;],
     	$_POST[&quot;brand_cap_answer&quot;]);
     	if ($resp-&gt;is_valid) {
		// Your code here to handle a successful verification
     		echo &quot;You got it!&quot;;
     	} else {
     		# set the error code so that we can display it
     		$error = $resp-&gt;error;
     	}
   }<br /><br />  ?&gt;</pre>
  <p>In the code above:</p>
  <li>brandcaptcha_check_answer returns an object that represents whether the user successfully completed the challenge.</li>
  <li>If $resp-&gt;is_valid is true then the captcha challenge was correctly completed and you should continue with form processing.</li>
  <li>If $resp-&gt;is_valid is false then the user failed to provide the correct captcha text and you should redisplay the form to allow them another attempt. In this case $resp-&gt;error will be an error code that can be provided to brandcaptcha_get_html. Passing the error code makes the BrandCAPTCHA control display a message explaining that the user entered the text incorrectly and should try again.</li>
  <p>Notice that this code is asking for the <strong>private</strong> key, which should not be confused with the public key.</p>
  <p>Also make sure your form is set to get the form variables using $_POST, instead of $_REQUEST, and that the form itself is using the POST method.</p>
  <p>That's it! BrandCAPTCHA should now be working on your site.</p>
</div>
</body>
</html>
